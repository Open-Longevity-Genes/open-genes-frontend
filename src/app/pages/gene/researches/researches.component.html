<section *ngIf="isAgeRelatedChanges">
  <h4>{{ "gene_page_researches_age_related_changes" | translate }}</h4>
  <div class="table-section __mt-20 __w-content">
    <table class="table table--sticky table--age-related-change">
      <thead>
      <th class="__cell-width-small">
        {{ "age_related_changes_type" | translate }}
      </th>
      <th>{{ "researches_object" | translate }}</th>
      <th>{{ "researches_line" | translate }}</th>
      <th>{{ "age_related_changes_sample" | translate }}</th>
      <th>{{ "researches_age_from" | translate }}</th>
      <th>{{ "researches_age_to" | translate }}</th>
      <th>{{ "age_related_changes_measurement_method" | translate }}</th>
      <th>
        {{ "researches_change" | translate }}&nbsp;<span
        class="fa fal fa-mars"
      ></span>
      </th>
      <th>
        {{ "researches_change" | translate }}&nbsp;<span
        class="fa fal fa-venus"
      ></span>
      </th>
      <th>
        {{ "researches_change" | translate }}&nbsp;<span
        class="fa fal fa-venus"
      ></span
      >&nbsp;<span class="fa fal fa-mars"></span>
      </th>
      <th>
        {{ "researches_comment" | translate }}
      </th>
      </thead>
      <tbody>
      <tr *ngFor="let item of researches.ageRelatedChangesOfGene">
        <td>
          <ng-container *ngIf="item.changeType ; else dash">
            {{ item.changeType }}
          </ng-container>
        </td>
        <td class="__nowrap">
          <ng-container *ngIf="item.modelOrganism ; else dash">
            {{ item.modelOrganism }}
          </ng-container>
        </td>
        <td class="__nowrap">
          <ng-container *ngIf="item.organismLine ; else dash">
            {{ item.organismLine }}
          </ng-container>
        </td>
        <td>
          <ng-container *ngIf="item.sample ; else dash">
            {{ item.sample }}
          </ng-container>
        </td>
        <td class="__nowrap">
          <ng-container *ngIf="item.ageFrom ; else dash">
            {{ item.ageFrom }}
          </ng-container>
        </td>
        <td class="__nowrap">
          <ng-container *ngIf="item.ageTo ; else dash">
            {{ item.ageTo }}
          </ng-container>
        </td>
        <td class="__nowrap">
          <ng-container *ngIf="item.measurementType ; else dash">
            {{ item.measurementType }}
          </ng-container>
        </td>
        <td class="__nowrap">
          <ng-container *ngIf="item.valueForMale ; else dash">
            {{ item.valueForMale }}
          </ng-container>
        </td>
        <td class="__nowrap">
          <ng-container *ngIf="item.valueForFemale ; else dash">
            {{ item.valueForFemale }}
          </ng-container>
        </td>
        <td class="__nowrap">
          <ng-container *ngIf="item.valueForAll ; else dash">
            {{ item.valueForAll }}
          </ng-container>
        </td>
        <td>
          <button class="btn btn--small btn--purple btn--flat"
                  (click)="openCommentModal('researches_comment', item, links)"
          >
            {{ "researches_comment_button" | translate }}
          </button>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</section>


<section *ngIf="isIncreaseLifespan">
  <h4>{{ "gene_page_researches_lifespan" | translate }}</h4>
  <app-hint hintType="emphasized">
    <ng-container title><span
      class="fa far fa-exclamation-triangle"></span> {{ "warning_researches_title" | translate }}</ng-container>
    <ng-container description>{{ "warning_researches_description" | translate }}</ng-container>
    <ng-container button>
      <a class="btn btn--fill btn--small btn--white"
         target="_blank"
         href="https://shortest.link/2MdQ"
      >
        {{ 'warning_researches_button' | translate }}
      </a>
    </ng-container>
  </app-hint>

  <div class="table-section __mt-20 __w-content">
      <table class="table">
        <thead>
        <!-- General data columns -->
        <th>Модельный организм, пол, линия</th>
        <th>Результат</th>
        <th>Основной эффект воздействия</th>
        <th>Способ воздействия, метод</th>
        <th>Размер групп <br>контроля и эксперимента</th>
        <th>Условия содержания</th>
        <th>Изменение экспрессии целевого гена (%)</th>
        <th>Продолжительность жизни контроля</th>
        <th>Продолжительность жизни эксперимента</th>
        <th>Продолжительность жизни, % изменения <br>(мин, средняя, медиана, макс), значимость да/нет</th>
        <th>Другие результаты</th>
        <!-- Control & experiment data columns -->
        <th>Тканеспецифичность</th>
        </thead>
        <tbody>
        <tr *ngFor="let research of researches.increaseLifespan; let i = index">
          <!-- One row with: -->

          <!-- General data columns -->
          <td>
            {{ research.modelOrganism }}, пол {{ research.sex }}, линия {{ research.organismLine }}
          </td>
          <td>{{ research.interventionResultForLifespan }}</td>
          <td>(нет поля)</td>
          <td>(нет поля)</td>
          <td>
            <p>Контроль: {{ research.controlCohortSize }}</p>
            <p>Эксперимент: {{ research.experimentCohortSize }}</p>
          </td>
          <td>
            <p>Плотность содержания: {{ research.density }}</p>
            <p>t<sup>°</sup>: {{ research.temperatureFrom }}—{{ research.temperatureTo }}</p>
            <p>Корм: {{ research.diet }}</p>
          </td>
          <td>Изменение экспрессии целевого гена (%)</td>
          <td>
            <p>Min: {{ research.lifespanMinControl }} {{ research.lifespanTimeUnit }}</p>
            <p>Mean: {{ research.lifespanMeanControl }} {{ research.lifespanTimeUnit }}</p>
            <p>Median: {{ research.lifespanMedianControl }} {{ research.lifespanTimeUnit }}</p>
            <p>Max: {{ research.lifespanMaxControl }} {{ research.lifespanTimeUnit }}</p>
          </td>
          <td>
            <p>Min: {{ research.lifespanMinExperiment }} {{ research.lifespanTimeUnit }}</p>
            <p>Mean: {{ research.lifespanMeanExperiment }} {{ research.lifespanTimeUnit }}</p>
            <p>Median: {{ research.lifespanMedianExperiment }} {{ research.lifespanTimeUnit }}</p>
            <p>Max: {{ research.lifespanMaxExperiment }} {{ research.lifespanTimeUnit }}</p>
          </td>
          <td>
            <p>Min: {{ research.lifespanMinChangePercent }}%, p-value {{ research.lMinChangeStatSignificance }}</p>
            <p>Mean: {{ research.lifespanMeanChangePercent }}%, p-value {{ research.lMeanChangeStatSignificance }}</p>
            <p>Median: {{ research.lifespanMedianChangePercent }}%, p-value {{ research.lMedianChangeStatSignificance }}</p>
            <p>Max: {{ research.lifespanMaxChangePercent }}%, p-value {{ research.lMaxChangeStatSignificance }}</p>
          </td>
          <td>
            <ng-container
              *ngIf="research?.interventionDeteriorates || research?.interventionImproves;
              else dash">
              <ng-container *ngIf="research?.interventionDeteriorates.length !== 0">
                <h6>{{ "researches_deteriorates" | translate }}</h6>
                <ul class="list list--bulletted __mt-0">
                  <li *ngFor="let result of research.interventionDeteriorates">
                    {{ result.name }}
                  </li>
                </ul>
              </ng-container>

              <ng-container *ngIf="research?.interventionImproves.length !== 0">
                <h6>{{ "researches_improves" | translate }}</h6>
                <ul class="list list--bulletted __mt-0">
                  <li *ngFor="let result of research.interventionImproves">
                    {{ result.name }}
                  </li>
                </ul>
              </ng-container>
            </ng-container>
          </td>

          <!-- Control & experiment data columns -->
          <ng-container *ngIf="research.interventions">
            <ng-container *ngFor="let sample of research.interventions.controlAndExperiment">
              <ng-container *ngIf="!sample.hasOwnProperty('gene')">
                <td>
                  <ng-container *ngIf="sample.tissueSpecific; else dash">
                    <p>Промотор: {{ sample.tissueSpecificPromoter }}</p>

                    <ul *ngIf="sample.tissues.length !== 0"
                        class="list">
                      <li *ngFor="let tissue of sample.tissues">
                        {{ tissue.name }}
                      </li>
                    </ul>
                  </ng-container>
                </td>
              </ng-container>
            </ng-container>

            <!-- Experiment data columns -->
            <ng-container *ngFor="let sample of research.interventions.experiment">
              <td>
                <ng-container *ngIf="sample.tissueSpecific; else dash">
                  <p>Промотор: {{ sample.tissueSpecificPromoter }}</p>

                  <ul *ngIf="sample.tissues.length !== 0"
                      class="list">
                    <li *ngFor="let tissue of sample.tissues">
                      {{ tissue.name }}
                    </li>
                  </ul>
                </ng-container>
              </td>
            </ng-container>
          </ng-container>
        </tr>
        </tbody>
      </table>
  </div>
</section>

<section *ngIf="isInterventionAffectsAgingProcess">
  <h4>{{ "gene_page_intervention_moderates_aging" | translate }}</h4>
  <div class="table-section __mt-20 __w-content">
    <table class="table table--sticky table--gene-intervention-to-vital-processes">
      <thead>
      <th class="__cell-width-small">
        {{ "gene_intervention_type" | translate }}
      </th>
      <th class="__cell-width-small">
        {{ "gene_intervention_result" | translate }}
      </th>
      <th>{{ "researches_object" | translate }}</th>
      <th>{{ "researches_age" | translate }}<sup>*</sup></th>
      <th>{{ "researches_sex" | translate }}</th>
      <th>{{ "researches_line" | translate }}</th>
      <th>{{ "researches_genotype" | translate }}</th>
      <th>
        {{ "researches_comment" | translate }}
      </th>
      </thead>

      <tr
        *ngFor="let item of researches.interventionToGeneImprovesVitalProcesses"
      >
        <td>
          <ng-container *ngIf="item.geneIntervention; else dash">
            {{ item.geneIntervention }}
          </ng-container>
        </td>
        <td>
          <ng-container
            *ngIf="item?.interventionDeteriorates || item?.interventionImproves;
            else dash">
            <ng-container *ngIf="item?.interventionDeteriorates.length !== 0">
              <h6>{{ "researches_deteriorates" | translate }}</h6>
              <ul class="list list--bulletted __mt-0">
                <li *ngFor="let result of item.interventionDeteriorates">
                  {{ result.name }}
                </li>
              </ul>
            </ng-container>

            <ng-container *ngIf="item?.interventionImproves.length !== 0">
              <h6>{{ "researches_improves" | translate }}</h6>
              <ul class="list list--bulletted __mt-0">
                <li *ngFor="let result of item.interventionImproves">
                  {{ result.name }}
                </li>
              </ul>
            </ng-container>
          </ng-container>
        </td>

        <td class="__nowrap">
          <ng-container *ngIf="item.modelOrganism ; else dash">
            {{ item.modelOrganism }}
          </ng-container>
        </td>
        <td class="__nowrap">
          <ng-container *ngIf="item.age ; else dash">
            {{ item.age }}
          </ng-container>
        </td>
        <td class="__nowrap">
          <ng-container *ngIf="item.sex ; else dash">
            {{ item.sex }}
          </ng-container>
        </td>
        <td>
          <ng-container *ngIf="item.organismLine ; else dash">
            {{ item.organismLine }}
          </ng-container>
        </td>
        <td class="__nowrap">
          <ng-container *ngIf="item.genotype ; else dash">
            {{ item.genotype }}
          </ng-container>
        </td>
        <td>
          <button class="btn btn--small btn--purple btn--flat"
                  (click)="openCommentModal('researches_comment', item, links)"
          >
            {{ "researches_comment_button" | translate }}
          </button>
        </td>
      </tr>
    </table>
  </div>
  <legend class="reference">
    <sup>*</sup>{{ "gene_page_researches_lifespan_hint1" | translate }}
  </legend>
</section>

<section *ngIf="isProteinRegulatesOtherGenes">
  <h4>{{ "gene_page_researches_protein_regulates_genes" | translate }}</h4>
  <div class="table-section __mt-20 __w-content">
    <table class="table table--sticky table--protein-to-gene">
      <thead>
      <th class="__cell-width-small">
        {{ "protein_regulates_genes_activity" | translate }}
      </th>
      <th>{{ "gene" | translate }}</th>
      <th>{{ "researches_regulation_type" | translate }}</th>
      <th>
        {{ "researches_comment" | translate }}
      </th>
      </thead>

      <tr *ngFor="let item of researches.proteinRegulatesOtherGenes">
        <td>
          <ng-container *ngIf="item.proteinActivity ; else dash">
            {{ item.proteinActivity }}
          </ng-container>
        </td>
        <td>
          <a href="gene/{{ item.regulatedGene.symbol }}" class="link">{{
            item.regulatedGene.symbol
            }}</a>
        </td>
        <td>
          <ng-container *ngIf="item.regulationType ; else dash">
            {{ item.regulationType }}
          </ng-container>
        </td>
        <td>
          <button class="btn btn--small btn--purple btn--flat"
                  (click)="openCommentModal('researches_comment', item, links)"
          >
            {{ "researches_comment_button" | translate }}
          </button>
        </td>
      </tr>
    </table>
  </div>
</section>

<section *ngIf="isGeneAssociatedWithProgeriaSyndromes">
  <h4>{{ "gene_page_researches_progeria" | translate }}</h4>
  <div class="table-section __mt-20 __w-content">
    <table class="table table--sticky table--gene-to-progeria">
      <thead>
      <th>{{ "progeria_syndrome" | translate }}</th>
      <th>
        {{ "researches_comment" | translate }}
      </th>
      </thead>

      <tr *ngFor="let item of researches.geneAssociatedWithProgeriaSyndromes">
        <td>
          <ng-container *ngIf="item.progeriaSyndrome ; else dash">
            {{ item.progeriaSyndrome }}
          </ng-container>
        </td>
        <td>
          <button class="btn btn--small btn--purple btn--flat"
                  (click)="openCommentModal('researches_comment', item, links)"
          >
            {{ "researches_comment_button" | translate }}
          </button>
        </td>
      </tr>
    </table>
  </div>
</section>

<section *ngIf="isGeneAssociatedWithLongevityEffects">
  <h4>{{ "gene_page_researches_longevity_effects" | translate }}</h4>
  <div class="table-section __mt-20 __w-content">
    <table class="table table--sticky table--gene-to-longevity-effect">
      <thead>
      <th>{{ "researches_data_type" | translate }}</th>
      <th class="__cell-width-small">
        {{ "researches_phenotype" | translate }}
      </th>
      <th class="__cell-width-small">
        {{ "gene_page_allelic_polymorphism" | translate }}
      </th>
      <th class="__cell-width-small">
        {{ "researches_allelic_variant" | translate }}
      </th>
      <th>{{ "gene_page_researches_transcriptome_proteome" | translate }}</th>
      <th>{{ "researches_model_organism" | translate }}</th>
      <th>{{ "researches_sex" | translate }}</th>
      <th>
        {{ "researches_comment" | translate }}
      </th>
      </thead>

      <tr *ngFor="let item of researches.geneAssociatedWithLongevityEffects">
        <td>
          <ng-container *ngIf="item.dataType ; else dash">
            {{ item.dataType }}
          </ng-container>
        </td>
        <td>
          <ng-container *ngIf="item.longevityEffect ; else dash">
            {{ item.longevityEffect }}
          </ng-container>
        </td>
        <td>
          <ng-container *ngIf="item.allelicPolymorphism ; else dash">
            {{ item.allelicPolymorphism }}
          </ng-container>
        </td>
        <td>
          <ng-container *ngIf="item.allelicVariant ; else dash">
            {{ item.allelicVariant }}
          </ng-container>
        </td>
        <td>
          <ng-container *ngIf="item.changeType ; else dash">
            {{ item.changeType }}
          </ng-container>
        </td>
        <td class="__nowrap">
          <ng-container *ngIf="item.modelOrganism ; else dash">
            {{ item.modelOrganism }}
            {{ item.modelOrganism }}
          </ng-container>
        </td>
        <td>
          <ng-container *ngIf="item.sex ; else dash">
            {{ item.sex }}
          </ng-container>
        </td>
        <td>
          <button class="btn btn--small btn--purple btn--flat"
                  (click)="openCommentModal('researches_comment', item, links)"
          >
            {{ "researches_comment_button" | translate }}
          </button>
        </td>
      </tr>
    </table>
  </div>
</section>

<section *ngIf="isAdditionalEvidences">
  <h4>{{ "gene_page_researches_additional_evidence" | translate }}</h4>
  <div class="table-section __mt-20 __w-content">
    <table class="table table--sticky table--gene-to-additional-evidence">
      <thead>
      <th>
        {{ "researches_comment" | translate }}
      </th>
      <th>
        {{ "researches_reference" | translate }}
      </th>
      </thead>

      <tr *ngFor="let item of researches.additionalEvidences">
        <td>
          {{ item.comment }}
        </td>
        <td>
          <a
            *ngIf="item?.doi !== ''"
            href="https://doi.org/{{ item?.doi }}"
            class="link"
            target="_blank"
          >{{ item?.doi }}</a
          ><br>

          <a
            *ngIf="item?.pmid !== ''"
            href="https://pubmed.ncbi.nlm.nih.gov/17170002/{{ item?.pmid }}"
            class="link"
            target="_blank"
          >{{ item?.pmid }}</a>
        </td>
      </tr>
    </table>
  </div>
</section>

<!-- DRY -->
<ng-template #links let-item="item">
  <p *ngIf="item?.comment.length !== 0">
    {{ item?.comment }}
  </p>

  <p *ngIf="item?.doi !== ''">
    <a
      href="https://doi.org/{{ item?.doi }}"
      class="link"
      target="_blank"
    >{{ item?.doi }}</a>
  </p>
  <p *ngIf="item?.pmid !== ''">
    <a
      href="https://pubmed.ncbi.nlm.nih.gov/17170002/{{ item?.pmid }}"
      class="link"
      target="_blank"
    >{{ item?.pmid }}</a>
  </p>

  <app-publication-info *ngIf="item?.doi"
                        [doi]="item.doi"
                        class="publication-info"
  ></app-publication-info>
</ng-template>

<ng-template #dash>
  <span class="table__dash"></span>
</ng-template>